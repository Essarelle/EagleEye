project(frame_grabber_openni2)

file(GLOB_RECURSE src "src/*.h" "src/*.cpp")
LIST(APPEND CMAKE_MODULE_PATH ${CMAKE_CURRENT_SOURCE_DIR}/cmake)
find_package(OpenNI2 QUIET)
find_package(OpenCV REQUIRED COMPONENTS cudaarithm)
if(OPENNI2_INCLUDE_DIR)
  include_directories(${OPENNI2_INCLUDE_DIR})
  add_library(frame_grabber_openni2 SHARED ${src})
  add_dependencies(frame_grabber_openni2 Aquila)
  RCC_LINK_LIB(frame_grabber_openni2 Aquila ${OPENNI2_LIBRARY} MetaObject RuntimeObjectSystem RuntimeCompiler ${OpenCV_LIBS})
  INCLUDE(../PluginTemplate.cmake)
  find_path(OPENNI2_BIN_DIR NAMES OpenNI2.dll PATHS ${OPENNI2_LIB_DIR}/../Redist)
  set(OPENNI2_BIN_DIR_DBG ${OPENNI2_BIN_DIR} CACHE PATH "" FORCE)
  set(OPENNI2_BIN_DIR_OPT ${OPENNI2_BIN_DIR} CACHE PATH "" FORCE)
  SET(BIN_DIRS "${BIN_DIRS};OPENNI2" CACHE STRING "" FORCE)
else()
  message("-- OpenNI2\t\tNotFound")
endif()
